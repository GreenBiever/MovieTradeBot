<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Профиль</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <video playsinline autoplay muted loop poster="">
        <source src="/media/videos/244fb7b9916aed280fa86e465ba74e2b.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <!-- Контейнер для контента -->
    <div class="container">
        <!-- Создать промик -->
        <div class="promo-create">
            <span class="label">Ваш тэг:</span>
            <input id="input-promo" type="text" placeholder="Новый промокод">
            <button class="button-tag" onclick="updatePromo()">✓</button>
        </div>
        <!-- Управление промокодами -->
        <h1 class="notifications-label">Управление промокодами</h1>
        <div class="promo-control">

        </div>
        


        <!-- Меню -->
        <div class="menu">
            <a id="home-link" href="index.html">
                <img src="/media/images/free-icon-font-money-check-7928280 1.svg" alt="Promocode Icon">
            </a>
            <a id="promocode-link" href="">
                <img src="/media/images/free-icon-font-shield-check-3917625 1.svg" alt="Security Icon">
            </a>
            <a id="bag-link" href="#bag">
                <img src="/media/images/free-icon-font-briefcase-3916670 1.svg" alt="Bag Icon">
            </a>
            <a id="scroll-link" href="#scroll">
                <img src="/media/images/free-icon-font-list-3917113 1.svg" alt="Scroll Icon">
            </a>
        </div>
    </div>

    <script>
        const params1 = new URLSearchParams(window.location.search);
        const id = params1.get('id');

        // Если id существует, обновляем ссылки
        if (id) {
            document.getElementById('home-link').href = `/?id=${id}`;
            document.getElementById('promocode-link').href = ``;
            document.getElementById('bag-link').href = `#bag/?id=${id}`;
            document.getElementById('scroll-link').href = `#scroll/?id=${id}`;
        }
    </script>
    <script>
        const params = new URLSearchParams(window.location.search);
        const tgId = params.get('id');

        // Функция для загрузки промокодов
        async function loadPromocodes() {
            try {
                if (tgId) {
                    const response = await fetch(`/promocode/${tgId}`);
                    const data = await response.json();

                    // Если промокоды существуют, создаем кнопки
                    if (data.promocodes && data.promocodes.length > 0) {
                        const promoControl = document.querySelector('.promo-control');

                        data.promocodes.forEach(promocode => {
                            const button = document.createElement('button');
                            button.textContent = promocode.name;
                            button.classList.add('promo-button');
                            button.onclick = () => applyPromocode(promocode.id);  // Обработка нажатия на кнопку
                            promoControl.appendChild(button);
                        });
                    } else {
                        document.querySelector('.promo-control').innerHTML = '<p>Промокоды отсутствуют.</p>';
                    }
                }
            } catch (error) {
                console.error('Ошибка при загрузке промокодов:', error);
            }
        }

        // Функция для применения промокода
        function applyPromocode(promocodeId) {
            console.log(`Промокод с ID ${promocodeId} применен!`);
            // Здесь можно реализовать логику для применения промокода
        }

        // Загрузка промокодов при загрузке страницы
        loadPromocodes();
    </script>
</body>
</html>
